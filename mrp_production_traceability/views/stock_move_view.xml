<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

    <!-- stock.production.lot views -->
    <record id="view_production_lot_form_inh_productiontrace" model="ir.ui.view">
        <field name="name">view.production.lot.form.inh.productiontrace</field>
        <field name="model">stock.production.lot</field>
        <field name="inherit_id" ref="stock.view_production_lot_form" />
        <field name="arch" type="xml">
           <button name="action_traceability" position="after">
            <button name="total_traceability" icon="fa-arrows-v" class="oe_stat_button" type="object" string="Full traceability"
            attrs="{'invisible': [('quant_ids','=',[])]}"/>
           </button>
            <field name="ref" position="after">
                <field name="parent_id"></field>
            </field>
        </field>
    </record>

    <record id="view_lot_traceability_tree" model="ir.ui.view">
        <field name="name">stock.production.lot.traceability.tree</field>
        <field name="model">stock.production.lot</field>
        <field name="field_parent">children_ids</field>
        <field name="arch" type="xml">
            <tree string="Production lot traceability" toolbar="1">
                <field name="name"/>
            </tree>
        </field>
    </record>
    <record id="action_lot_traceability_tree" model="ir.actions.act_window">
        <field name="name">Production Lots traceability</field>
        <field name="res_model">stock.production.lot</field>
        <field name="domain">[('parent_id','=',False)]</field>
        <field name="view_type">tree</field>
        <field name="view_id" ref="view_lot_traceability_tree"/>
    </record>

    <!-- stock.move views -->
    <record id="stock_move_tree_inh_productiontrace" model="ir.ui.view">
        <field name="name">stock.move.tree.inh.productiontrace</field>
        <field name="model">stock.move</field>
        <field name="inherit_id" ref="stock.stock_move_tree" />
        <field name="arch" type="xml">
            <field name="picking_id" position="after">
                <field name="final_product" />
                <field name="prod_parent_lot" />
            </field>
        </field>
    </record>
    <record id="view_move_tree_inh_productiontrace" model="ir.ui.view">
        <field name="name">view_move_tree.inh.productiontrace</field>
        <field name="model">stock.move</field>
        <field name="inherit_id" ref="stock.view_move_tree" />
        <field name="arch" type="xml">
            <field name="picking_id" position="after">
                <field name="final_product" />
                <field name="prod_parent_lot" />
            </field>
        </field>
    </record>
    <record id="view_move_picking_tree_inh_productiontrace" model="ir.ui.view">
        <field name="name">view.move.picking.tree.inh.productiontrace</field>
        <field name="model">stock.move</field>
        <field name="inherit_id" ref="stock.view_move_picking_tree" />
        <field name="arch" type="xml">
            <field name="picking_id" position="after">
                <field name="final_product" invisible="1"/>
                <field name="prod_parent_lot" invisible="1"/>
            </field>
        </field>
    </record>
    <record id="view_move_search_inh_productiontrace" model="ir.ui.view">
        <field name="name">view.move.search.inh.productiontrace</field>
        <field name="model">stock.move</field>
        <field name="inherit_id" ref="stock.view_move_search" />
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <field name="prod_parent_lot" />
                <field name="final_product" />
            </field>
            <filter string="Product" position="before">
                <filter string="Parent production lot" name="by_prod_parent_lot" domain="[]"  context="{'group_by':'prod_parent_lot'}"/>
                <filter string="Final Product" name="by_final_product" domain="[]"  context="{'group_by':'final_product'}"/>
            </filter>
        </field>
    </record>
    </data>
</openerp>
